#include "devscc.h"
#include "sf-types.h"
#include "sh7708.h"

#include "e-types.h"

int a = 0xBEEF;

int main(void) {
  volatile unsigned int *gDebugLedsMemoryMappedRegister = (unsigned int *)0x2000;
  *gDebugLedsMemoryMappedRegister = 0b00000010;

  // Standard arithmetic
  int a, b, c = 0;
  for (int i = 0; i < 200; i ++) {
    a = a + 5;
    b = a - i;
    c = b << 3;
    a = b & c;
    c = a | b;
    a = b >> 2;
    b = ~a;
    c = a ^ i;
    if (a >= 2) {
      b = a < 2;
    } else if (b > -5) {
      c = a < 2;
    }
    switch (b) {
      case 5:
        b --;
        break;
      case 6:
        c --;
        break;
    }
  }

  // Bubblesort
  uchar bsort_input[] = {
    0x2e, 0x2e, 0x2e, 0x53, 0x69, 0x6e, 0x67, 0x20, 0x74, 0x6f, 0x20, 0x6d, 0x65, 0x20, 0x6f, 0x66, 0x20, 0x74, 0x68, 0x65, 0x20, 0x6d, 0x61, 0x6e, 0x2c, 0x20, 0x4d, 0x75, 0x73, 0x65, 0x2c, 0x20, 0x74, 0x68, 0x65, 0x20, 0x6d, 0x61, 0x6e, 0x20, 0x6f, 0x66, 0x20, 0x74, 0x77, 0x69, 0x73, 0x74, 0x73, 0x20, 0x61, 0x6e, 0x64, 0x20, 0x74, 0x75, 0x72, 0x6e, 0x73, 0x2e, 0x2e, 0x2e, 0x53, 0x69, 0x6e, 0x67, 0x20, 0x74, 0x6f, 0x20, 0x6d, 0x65, 0x20, 0x6f, 0x66, 0x20, 0x74, 0x68, 0x65, 0x20, 0x6d, 0x61, 0x6e, 0x2c, 0x20, 0x4d, 0x75, 0x73, 0x65, 0x2c, 0x20, 0x74, 0x68, 0x65, 0x20, 0x6d, 0x61, 0x6e, 0x11, 0xee
  };
  const int bsort_input_len = 100;
  int i;
  int maxindex = bsort_input_len - 1;
  while (maxindex > 0) {
    for (i = 0; i < maxindex; i++) {
      if (bsort_input[i] > bsort_input[i + 1]) {
        /*		swap		*/
        bsort_input[i] ^= bsort_input[i + 1];
        bsort_input[i + 1] ^= bsort_input[i];
        bsort_input[i] ^= bsort_input[i + 1];
      }
    }
    maxindex--;
  }

  *gDebugLedsMemoryMappedRegister = 0b00000001;
  return 0;
}
